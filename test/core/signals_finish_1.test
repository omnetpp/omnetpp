%description:
Test that modules call finish() on listeners, and that
module destructors unsubscribe listeners

%includes:
#include "../lib/noisylistener.h"
using namespace testlib;

%activity:
EV << "Subscribing:\n";
NoisyListener *listener = new NoisyListener();
subscribe("dummy", listener);

%extraargs: --cmdenv-log-cleanup=true

%contains: stdout
Subscribing:
NOISYLISTENER CONSTRUCTOR
SUBSCRIBED at module "Test", signal "dummy"

%contains: stdout
FINISH on module "Test", signal "dummy"
UNSUBSCRIBED from module "Test", signal "dummy"

